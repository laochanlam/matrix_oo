#include "matrix.h"
#include <stdio.h>

MatrixAlgo *matrix_providers[] = {
    &NaiveMatrixProvider,
};

int main()
{
    MatrixAlgo *algo = matrix_providers[0];

    Matrix dst, m, n, fixed;
    algo->assign(&m, (Mat8x8) {
        .values = {
            { 0,  1,  2,  3,   0,  1,  2,  3, },
            { 4,  5,  6,  7,   4,  5,  6,  7, },
            { 8,  9, 10, 11,   8,  9, 10, 11, },
            { 12, 13, 14, 15, 12, 13, 14, 15, },
            { 0,  1,  2,  3,   0,  1,  2,  3, },
            { 4,  5,  6,  7,   4,  5,  6,  7, },
            { 8,  9, 10, 11,   8,  9, 10, 11, },
            { 12, 13, 14, 15, 12, 13, 14, 15, },
        },
    });

    algo->assign(&n, (Mat8x8) {
        .values = {
            {  16, 17, 18, 19, 16, 17, 18, 19, },
            {  20, 21, 22, 23, 20, 21, 22, 23, },
            {  24, 25, 26, 27, 24, 25, 26, 27, },
            {  28, 29, 30, 31, 28, 29, 30, 31, },
            {  16, 17, 18, 19, 16, 17, 18, 19, },
            {  20, 21, 22, 23, 20, 21, 22, 23, },
            {  24, 25, 26, 27, 24, 25, 26, 27, },
            {  28, 29, 30, 31, 28, 29, 30, 31, },
        },
    });

    algo->mul(&dst, &m, &n);

    algo->assign(&fixed, (Mat8x8) {
        .values = {
            {  304,  316,  328,  340,  304,  316,  328,  340,  },
            {  1008, 1052, 1096, 1140, 1008, 1052, 1096, 1140, },
            {  1712, 1788, 1864, 1940, 1712, 1788, 1864, 1940, },
            {  2416, 2524, 2632, 2740, 2416, 2524, 2632, 2740, },
            {  304,  316,  328,  340,  304,  316,  328,  340,  },
            {  1008, 1052, 1096, 1140, 1008, 1052, 1096, 1140, },
            {  1712, 1788, 1864, 1940, 1712, 1788, 1864, 1940, },
            {  2416, 2524, 2632, 2740, 2416, 2524, 2632, 2740  },
        },
    });

    if (algo->equal(&dst, &fixed))
        return 0;
    return -1;
}
